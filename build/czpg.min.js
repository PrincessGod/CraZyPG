!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.CZPG={})}(this,function(t){"use strict";var e={},r="a_position",n=0,i="a_normal",a=1,o="a_uv",s=2,u=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},h=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},f=function(){function t(e,r,n){u(this,t),this.x=e||0,this.y=r||0,this.z=n||0}return h(t,[{key:"magnitude",value:function(t){if(void 0===t)return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);var e=t.x-this.x,r=t.y-this.y,n=t.y-this.z;return Math.sqrt(e*e+r*r+n*n)}},{key:"normalize",value:function(){var t=this.magnitude();return this.x/=t,this.y/=t,this.z/=t,this}},{key:"set",value:function(t,e,r){return this.x=t,this.y=e,this.z=r,this}},{key:"multiScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"getArray",value:function(){return[this.x,this.y,this.z]}},{key:"getFloatArray",value:function(){return new Float32Array([this.x,this.y,this.z])}},{key:"clone",value:function(){return new t(this.x,this.y,this.z)}}]),t}(),c=function(){function t(){u(this,t),this.raw=t.identity()}return h(t,[{key:"vtranslate",value:function(e){return t.translate(this.raw,e.x,e.y,e.z),this}},{key:"translate",value:function(e,r,n){return t.translate(this.raw,e,r,n),this}},{key:"rotateY",value:function(e){return t.rotateY(this.raw,e),this}},{key:"rotateX",value:function(e){return t.rotateX(this.raw,e),this}},{key:"rotateZ",value:function(e){return t.rotateZ(this.raw,e),this}},{key:"vscale",value:function(e){return t.scale(this.raw,e.x,e.y,e.z),this}},{key:"scale",value:function(e,r,n){return t.scale(this.raw,e,r,n),this}},{key:"invert",value:function(){return t.invert(this.raw),this}},{key:"resetRotation",value:function(){for(var t=0;t<this.raw.length;t++)t>=12&&t<=14||(this.raw[t]=t%5==0?1:0);return this}},{key:"reset",value:function(){for(var t=0;t<this.raw.length;t++)this.raw[t]=t%5==0?1:0;return this}}],[{key:"identity",value:function(){var t=new Float32Array(16);return t[0]=t[5]=t[10]=t[15]=1,t}},{key:"perspective",value:function(t,e,r,n,i){var a=1/Math.tan(e/2),o=1/(n-i);t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+n)*o,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*n*o,t[15]=0}},{key:"ortho",value:function(t,e,r,n,i,a,o){var s=1/(e-r),u=1/(n-i),h=1/(a-o);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+r)*s,t[13]=(i+n)*u,t[14]=(o+a)*h,t[15]=1}},{key:"transpose",value:function(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],a=e[6],o=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[11]=e[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}},{key:"normalMat3",value:function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],h=e[7],l=e[8],f=e[9],c=e[10],v=e[11],m=e[12],d=e[13],p=e[14],y=e[15],A=r*s-n*o,g=r*u-i*o,R=r*h-a*o,w=n*u-i*s,_=n*h-a*s,x=i*h-a*u,M=l*d-f*m,E=l*p-c*m,b=l*y-v*m,T=f*p-c*d,k=f*y-v*d,L=c*y-v*p,F=A*L-g*k+R*T+w*b-_*E+x*M;return F?(F=1/F,t[0]=(s*L-u*k+h*T)*F,t[1]=(u*b-o*L-h*E)*F,t[2]=(o*k-s*b+h*M)*F,t[3]=(i*k-n*L-a*T)*F,t[4]=(r*L-i*b+a*E)*F,t[5]=(n*b-r*k-a*M)*F,t[6]=(d*x-p*_+y*w)*F,t[7]=(p*R-m*x-y*g)*F,t[8]=(m*_-d*R+y*A)*F,t):null}},{key:"multiplyVector",value:function(t,e){var r=e[0],n=e[1],i=e[2],a=e[3],o=t[0],s=t[1],u=t[2],h=t[3],l=t[4],f=t[5],c=t[6],v=t[7],m=t[8],d=t[9],p=t[10],y=t[11];return[r*o+n*l+i*m+a*t[12],r*s+n*f+i*d+a*t[13],r*u+n*c+i*p+a*t[14],r*h+n*v+i*y+a*t[15]]}},{key:"transformVec4",value:function(t,e,r){return t[0]=r[0]*e[0]+r[4]*e[1]+r[8]*e[2]+r[12]*e[3],t[1]=r[1]*e[0]+r[5]*e[1]+r[9]*e[2]+r[13]*e[3],t[2]=r[2]*e[0]+r[6]*e[1]+r[10]*e[2]+r[14]*e[3],t[3]=r[3]*e[0]+r[7]*e[1]+r[11]*e[2]+r[15]*e[3],t}},{key:"mult",value:function(t,e,r){var n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],u=e[5],h=e[6],l=e[7],f=e[8],c=e[9],v=e[10],m=e[11],d=e[12],p=e[13],y=e[14],A=e[15],g=r[0],R=r[1],w=r[2],_=r[3];return t[0]=g*n+R*s+w*f+_*d,t[1]=g*i+R*u+w*c+_*p,t[2]=g*a+R*h+w*v+_*y,t[3]=g*o+R*l+w*m+_*A,g=r[4],R=r[5],w=r[6],_=r[7],t[4]=g*n+R*s+w*f+_*d,t[5]=g*i+R*u+w*c+_*p,t[6]=g*a+R*h+w*v+_*y,t[7]=g*o+R*l+w*m+_*A,g=r[8],R=r[9],w=r[10],_=r[11],t[8]=g*n+R*s+w*f+_*d,t[9]=g*i+R*u+w*c+_*p,t[10]=g*a+R*h+w*v+_*y,t[11]=g*o+R*l+w*m+_*A,g=r[12],R=r[13],w=r[14],_=r[15],t[12]=g*n+R*s+w*f+_*d,t[13]=g*i+R*u+w*c+_*p,t[14]=g*a+R*h+w*v+_*y,t[15]=g*o+R*l+w*m+_*A,t}},{key:"scale",value:function(t,e,r,n){return t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,t[4]*=r,t[5]*=r,t[6]*=r,t[7]*=r,t[8]*=n,t[9]*=n,t[10]*=n,t[11]*=n,t}},{key:"rotateY",value:function(t,e){var r=Math.sin(e),n=Math.cos(e),i=t[0],a=t[1],o=t[2],s=t[3],u=t[8],h=t[9],l=t[10],f=t[11];return t[0]=i*n-u*r,t[1]=a*n-h*r,t[2]=o*n-l*r,t[3]=s*n-f*r,t[8]=i*r+u*n,t[9]=a*r+h*n,t[10]=o*r+l*n,t[11]=s*r+f*n,t}},{key:"rotateX",value:function(t,e){var r=Math.sin(e),n=Math.cos(e),i=t[4],a=t[5],o=t[6],s=t[7],u=t[8],h=t[9],l=t[10],f=t[11];return t[4]=i*n+u*r,t[5]=a*n+h*r,t[6]=o*n+l*r,t[7]=s*n+f*r,t[8]=u*n-i*r,t[9]=h*n-a*r,t[10]=l*n-o*r,t[11]=f*n-s*r,t}},{key:"rotateZ",value:function(t,e){var r=Math.sin(e),n=Math.cos(e),i=t[0],a=t[1],o=t[2],s=t[3],u=t[4],h=t[5],l=t[6],f=t[7];return t[0]=i*n+u*r,t[1]=a*n+h*r,t[2]=o*n+l*r,t[3]=s*n+f*r,t[4]=u*n-i*r,t[5]=h*n-a*r,t[6]=l*n-o*r,t[7]=f*n-s*r,t}},{key:"rotate",value:function(t,e,r){var n,i,a,o,s,u,h,l,f,c,v,m,d,p,y,A,g,R,w,_,x,M,E,b,T=r[0],k=r[1],L=r[2],F=Math.sqrt(T*T+k*k+L*L);if(Math.abs(F)<1e-6)return null;T*=F=1/F,k*=F,L*=F,n=Math.sin(e),a=1-(i=Math.cos(e)),o=t[0],s=t[1],u=t[2],h=t[3],l=t[4],f=t[5],c=t[6],v=t[7],m=t[8],d=t[9],p=t[10],y=t[11],A=T*T*a+i,g=k*T*a+L*n,R=L*T*a-k*n,w=T*k*a-L*n,_=k*k*a+i,x=L*k*a+T*n,M=T*L*a+k*n,E=k*L*a-T*n,b=L*L*a+i,t[0]=o*A+l*g+m*R,t[1]=s*A+f*g+d*R,t[2]=u*A+c*g+p*R,t[3]=h*A+v*g+y*R,t[4]=o*w+l*_+m*x,t[5]=s*w+f*_+d*x,t[6]=u*w+c*_+p*x,t[7]=h*w+v*_+y*x,t[8]=o*M+l*E+m*b,t[9]=s*M+f*E+d*b,t[10]=u*M+c*E+p*b,t[11]=h*M+v*E+y*b}},{key:"invert",value:function(t,e){void 0===e&&(e=t);var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],h=e[7],l=e[8],f=e[9],c=e[10],v=e[11],m=e[12],d=e[13],p=e[14],y=e[15],A=r*s-n*o,g=r*u-i*o,R=r*h-a*o,w=n*u-i*s,_=n*h-a*s,x=i*h-a*u,M=l*d-f*m,E=l*p-c*m,b=l*y-v*m,T=f*p-c*d,k=f*y-v*d,L=c*y-v*p,F=A*L-g*k+R*T+w*b-_*E+x*M;return!!F&&(F=1/F,t[0]=(s*L-u*k+h*T)*F,t[1]=(i*k-n*L-a*T)*F,t[2]=(d*x-p*_+y*w)*F,t[3]=(c*_-f*x-v*w)*F,t[4]=(u*b-o*L-h*E)*F,t[5]=(r*L-i*b+a*E)*F,t[6]=(p*R-m*x-y*g)*F,t[7]=(l*x-c*R+v*g)*F,t[8]=(o*k-s*b+h*M)*F,t[9]=(n*b-r*k-a*M)*F,t[10]=(m*_-d*R+y*A)*F,t[11]=(f*R-l*_-v*A)*F,t[12]=(s*E-o*T-u*M)*F,t[13]=(r*T-n*E+i*M)*F,t[14]=(d*g-m*w-p*A)*F,t[15]=(l*w-f*g+c*A)*F,!0)}},{key:"translate",value:function(t,e,r,n){t[12]=t[0]*e+t[4]*r+t[8]*n+t[12],t[13]=t[1]*e+t[5]*r+t[9]*n+t[13],t[14]=t[2]*e+t[6]*r+t[10]*n+t[14],t[15]=t[3]*e+t[7]*r+t[11]*n+t[15]}}]),t}(),v=function(){function t(){u(this,t),this.position=new f(0,0,0),this.scale=new f(1,1,1),this.rotation=new f(0,0,0),this.matLocal=new c,this.matNormal=new c,this.forward=new Float32Array(4),this.up=new Float32Array(4),this.right=new Float32Array(4)}return h(t,[{key:"updateMatrix",value:function(){return this.matLocal.reset().vtranslate(this.position).rotateZ(this.rotation.z*t.deg2Rad).rotateX(this.rotation.x*t.deg2Rad).rotateY(this.rotation.y*t.deg2Rad).vscale(this.scale),c.normalMat3(this.matNormal,this.matLocal.raw),c.transformVec4(this.forward,[0,0,1,0],this.matLocal.raw),c.transformVec4(this.up,[0,1,0,0],this.matLocal.raw),c.transformVec4(this.right,[1,0,0,0],this.matLocal.raw),this.matLocal.raw}},{key:"updateDirection",value:function(){return c.transformVec4(this.forward,[0,0,1,0],this.matLocal.raw),c.transformVec4(this.up,[0,1,0,0],this.matLocal.raw),c.transformVec4(this.right,[1,0,0,0],this.matLocal.raw),this}},{key:"getMatrix",value:function(){return this.matLocal.raw}},{key:"getNormalMatrix",value:function(){return this.matNormal}},{key:"reset",value:function(){this.position.set(0,0,0),this.scale.set(1,1,1),this.rotation.set(0,0,0)}}]),t}();v.deg2Rad=Math.PI/180;var m=function(){function t(e){u(this,t),this.mesh=e,this.transform=new v}return h(t,[{key:"setScale",value:function(t,e,r){return this.transform.scale.set(t,e,r),this}},{key:"setPosition",value:function(t,e,r){return this.transform.position.set(t,e,r),this}},{key:"setRotation",value:function(t,e,r){return this.transform.rotation.set(t,e,r),this}},{key:"addScale",value:function(t,e,r){return this.transform.scale.x+=t,this.transform.scale.y+=e,this.transform.scale.z+=r,this}},{key:"addPosition",value:function(t,e,r){return this.transform.position.x+=t,this.transform.position.y+=e,this.transform.position.z+=r,this}},{key:"addRotation",value:function(t,e,r){return this.transform.rotation.x+=t,this.transform.rotation.y+=e,this.transform.rotation.z+=r,this}},{key:"preRender",value:function(){return this.transform.updateMatrix(),this}}]),t}(),d={};d.GridAxis=function(){function t(){u(this,t)}return h(t,null,[{key:"createMesh",value:function(t){for(var r=[],i=void 0,a=0;a<=10;a++)i=.2*a-1,r.push(i),r.push(0),r.push(1),r.push(0),r.push(i),r.push(0),r.push(-1),r.push(0),r.push(-1),r.push(0),r.push(i),r.push(0),r.push(1),r.push(0),r.push(i),r.push(0);r.push(-1),r.push(0),r.push(0),r.push(1),r.push(1),r.push(0),r.push(0),r.push(1),r.push(0),r.push(-1),r.push(0),r.push(2),r.push(0),r.push(1),r.push(0),r.push(2),r.push(0),r.push(0),r.push(-1),r.push(3),r.push(0),r.push(0),r.push(1),r.push(3);var o=void 0,s={drawMode:t.LINES,vao:t.createVertexArray()};return s.vtxComponents=4,s.vtxCount=r.length/s.vtxComponents,o=Float32Array.BYTES_PER_ELEMENT*s.vtxComponents,s.vtxBuffer=t.createBuffer(),t.bindVertexArray(s.vao),t.bindBuffer(t.ARRAY_BUFFER,s.vtxBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(r),t.STATIC_DRAW),t.enableVertexAttribArray(n),t.enableVertexAttribArray(4),t.vertexAttribPointer(n,3,t.FLOAT,!1,o,0),t.vertexAttribPointer(4,1,t.FLOAT,!1,o,3*Float32Array.BYTES_PER_ELEMENT),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindVertexArray(null),e.gridAxis=s,s}}]),t}();var p=function(){function t(e,r,n,i){u(this,t),this.perspectionMatrix=new Float32Array(16),c.perspective(this.perspectionMatrix,e,r,n,i),this.transform=new v,this.viewMatrix=new Float32Array(16),this.mode=t.MODE_ORBIT}return h(t,[{key:"panX",value:function(e){this.mode!==t.MODE_ORBIT&&(this.updateViewMatrix(),this.transform.position.x+=this.transform.right[0]*e,this.transform.position.y+=this.transform.right[1]*e,this.transform.position.z+=this.transform.right[2]*e)}},{key:"panY",value:function(e){this.updateViewMatrix(),this.transform.position.y+=this.transform.up[1]*e,this.mode!==t.MODE_ORBIT&&(this.transform.position.x+=this.transform.up[0]*e,this.transform.position.z+=this.transform.up[2]*e)}},{key:"panZ",value:function(e){this.updateViewMatrix(),this.mode===t.MODE_ORBIT?this.transform.position.z+=e:(this.transform.position.x+=this.transform.forward[0]*e,this.transform.position.y+=this.transform.forward[1]*e,this.transform.position.z+=this.transform.forward[2]*e)}},{key:"updateViewMatrix",value:function(){return this.mode===t.MODE_FREE?this.transform.matLocal.reset().vtranslate(this.transform.position).rotateY(this.transform.rotation.y*v.deg2Rad).rotateX(this.transform.rotation.x*v.deg2Rad):this.transform.matLocal.reset().rotateY(this.transform.rotation.y*v.deg2Rad).rotateX(this.transform.rotation.x*v.deg2Rad).vtranslate(this.transform.position),this.transform.updateDirection(),c.invert(this.viewMatrix,this.transform.matLocal.raw),this.viewMatrix}}]),t}();p.MODE_FREE=0,p.MODE_ORBIT=1;var y=function(){function t(e,r){u(this,t);var n=this,i=e.canvas.getBoundingClientRect();this.canvas=e.canvas,this.camera=r,this.rotateRate=-300,this.panRate=5,this.zoomRate=200,this.offsetX=i.left,this.offsetY=i.top,this.initX=0,this.initY=0,this.prevX=0,this.prevY=0,this.onUpHandler=function(t){n.onMouseUp(t)},this.onMoveHandler=function(t){n.onMouseMove(t)},this.canvas.addEventListener("mousedown",function(t){n.onMouseDown(t)}),this.canvas.addEventListener("mousewheel",function(t){n.onMouseWheel(t)})}return h(t,[{key:"getMouseVec2",value:function(t){return{x:t.pageX-this.offsetX,y:t.pageY-this.offsetY}}},{key:"onMouseDown",value:function(t){this.initX=this.prevX=t.pageX-this.offsetX,this.initY=this.prevY=t.pageY-this.offsetY,this.canvas.addEventListener("mouseup",this.onUpHandler),this.canvas.addEventListener("mousemove",this.onMoveHandler)}},{key:"onMouseUp",value:function(){this.canvas.removeEventListener("mouseup",this.onMouseUp),this.canvas.removeEventListener("mousemove",this.onMoveHandler)}},{key:"onMouseWheel",value:function(t){var e=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail));this.camera.panZ(e*(this.zoomRate/this.canvas.height))}},{key:"onMouseMove",value:function(t){var e=t.pageX-this.offsetX,r=t.pageY-this.offsetY,n=e-this.prevX,i=r-this.prevY;t.shiftKey?(this.camera.panX(-n*(this.panRate/this.canvas.width)),this.camera.panY(i*(this.panRate/this.canvas.height))):(this.camera.transform.rotation.y+=n*(this.rotateRate/this.canvas.width),this.camera.transform.rotation.x+=i*(this.rotateRate/this.canvas.height)),this.prevX=e,this.prevY=r}}]),t}(),A=function(){function t(e,r){u(this,t);var n=this;this.lastTime=null,this.callback=e,this.isActive=!1,this.fps=0,"number"==typeof r&&r>0?(this.frameTimeLimit=1/r,this.run=function(){var t=performance.now(),e=(t-n.lastTime)/1e3;e>=n.frameTimeLimit&&(n.fps=Math.floor(1/e),n.lastTime=t,n.callback(e)),n.isActive&&window.requestAnimationFrame(n.run)}):this.run=function(){var t=performance.now(),e=(t-n.lastTime)/1e3;n.fps=Math.floor(1/e),n.lastTime=t,n.callback(e),n.isActive&&window.requestAnimationFrame(n.run)}}return h(t,[{key:"start",value:function(){return this.isActive=!0,this.lastTime=performance.now(),window.requestAnimationFrame(this.run),this}},{key:"stop",value:function(){this.isActive=!1}}]),t}(),g=function(){function t(){u(this,t)}return h(t,null,[{key:"getDomSrc",value:function(t){var e=document.getElementById(t);return e&&""!=e.textContent?e.textContent:(console.error(t+" shader element not have text."),null)}},{key:"createShader",value:function(t,e,r){var n=t.createShader(r);return t.shaderSource(n,e),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(console.error("Error compiling shader: "+e,t.getShaderInfoLog(n)),t.deleteShader(n),null)}},{key:"createProgram",value:function(t,e,u){var h=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(!(e instanceof WebGLShader)&&e.length<20){var l=this.getDomSrc(e);if(!l)return null;if(!(e=this.createShader(t,l,t.VERTEX_SHADER)))return null}else if(!(e instanceof WebGLShader||(e=this.createShader(t,e,t.VERTEX_SHADER))))return null;if(!(u instanceof WebGLShader)&&u.length<20){var f=this.getDomSrc(u);if(!f)return null;if(!(u=this.createShader(t,f,t.FRAGMENT_SHADER)))return null}else if(!(u instanceof WebGLShader||(u=this.createShader(t,u,t.FRAGMENT_SHADER))))return null;var c=t.createProgram();return t.attachShader(c,e),t.attachShader(c,u),t.bindAttribLocation(c,n,r),t.bindAttribLocation(c,a,i),t.bindAttribLocation(c,s,o),t.linkProgram(c),t.getProgramParameter(c,t.LINK_STATUS)?h&&(t.validateProgram(c),!t.getProgramParameter(c,t.VALIDATE_STATUS))?(console.error("Error validating shader program.",t.getProgramInfoLog(c)),t.deleteProgram(c),null):(t.detachShader(c,e),t.detachShader(c,u),t.deleteShader(e),t.deleteShader(u),c):(console.error("Error createing shader program.",t.getProgramInfoLog(c)),t.deleteProgram(c),null)}},{key:"getDefaultAttribLocation",value:function(t,e){return{position:t.getAttribLocation(e,r),normal:t.getAttribLocation(e,i),uv:t.getAttribLocation(e,o)}}},{key:"getDefaultUnifomLocation",value:function(t,e){return{perspective:t.getUniformLocation(e,"u_proj"),view:t.getUniformLocation(e,"u_view"),world:t.getUniformLocation(e,"u_world")}}}]),t}(),R=function(){function t(e,r,n){u(this,t),this.program=g.createProgram(e,r,n),null!==this.program&&(this.gl=e,e.useProgram(this.program),this.attribLoc=g.getDefaultAttribLocation(e,this.program),this.uniformLoc=g.getDefaultUnifomLocation(e,this.program))}return h(t,[{key:"activate",value:function(){return this.gl.useProgram(this.program),this}},{key:"deactivate",value:function(){return this.gl.useProgram(null),this}},{key:"setPerspective",value:function(t){return this.gl.uniformMatrix4fv(this.uniformLoc.perspective,!1,t),this}},{key:"setViewMatrix",value:function(t){return this.gl.uniformMatrix4fv(this.uniformLoc.view,!1,t),this}},{key:"setWorldMatrix",value:function(t){return this.gl.uniformMatrix4fv(this.uniformLoc.world,!1,t),this}},{key:"dispose",value:function(){this.gl.getParameter(this.gl.CURRENT_PROGRAM)===this.program&&this.gl.useProgram(null),this.gl.deleteProgram(this.program)}},{key:"preRender",value:function(){}},{key:"renderModal",value:function(t){return this.setWorldMatrix(t.transform.getMatrix()),this.gl.bindVertexArray(t.mesh.vao),t.mesh.indexCount?this.gl.drawElements(t.mesh.drawMode,t.mesh.indexCount,this.gl.UNSIGNED_SHORT,0):this.gl.drawArrays(t.mesh.drawMode,0,t.mesh.vtxCount),this.gl.bindVertexArray(null),this}}]),t}(),w=function(t){function e(t,r){u(this,e);var n=l(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,"#version 300 es\nin vec3 a_Position;\nlayout(location=4) in float a_Color;\n\nuniform mat4 u_world;\nuniform mat4 u_view;\nuniform mat4 u_proj;\nuniform vec3 u_colors[4];\n\nout vec3 v_color;\n\nvoid main() {\n    v_color = u_colors[int(a_Color)];\n    gl_Position = u_proj * u_view * u_world * vec4(a_Position, 1.0);\n}","#version 300 es\nprecision mediump float;\n\nin vec3 v_color;\nout vec4 finalColor;\n\nvoid main() {\n    finalColor = vec4(v_color, 1.0);\n}"));n.setPerspective(r);var i=t.getUniformLocation(n.program,"u_colors");return t.uniform3fv(i,[.5,.5,.5,1,0,0,0,1,0,0,0,1]),t.useProgram(null),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,R),e}();t.Transform=v,t.Modal=m,t.Primatives=d,t.OrbitCamera=p,t.CameraController=y,t.Render=A,t.ShaderUtil=g,t.Shader=R,t.GridAxisShader=w,t.meshs=e,t.VTX_ATTR_POSITION_NAME=r,t.VTX_ATTR_POSITION_LOC=n,t.VTX_ATTR_NORMAL_NAME=i,t.VTX_ATTR_NORMAL_LOC=a,t.VTX_ATTR_UV_NAME=o,t.VTX_ATTR_UV_LOC=s,t.getContext=function(t){var e=document.getElementById(t).getContext("webgl2",{antialias:!0});return e?(this.gl=e,this):(console.error("Please use a decent browser, this browser not support Webgl2Context."),null)},t.clear=function(){var t=this.gl;return t.clearColor(1,1,1,1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this},t.setSize=function(t,e,r){var n=this.gl;return r=r||1,r=Math.max(0,r),n.canvas.style.width=t,n.canvas.style.height=e,n.canvas.width=n.canvas.clientWidth*r,n.canvas.height=n.canvas.clientHeight*r,n.viewport(0,0,n.canvas.width,n.canvas.height),this},t.createArrayBuffer=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.gl,n=r.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,n),r.bufferData(r.ARRAY_BUFFER,t,e?r.STATIC_DRAW:r.DYNAMIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,null),n},t.createMeshVAO=function(t,e,r,i,o){var u=this.gl,h={darwMode:u.TRIANGLES};return h.vao=u.createVertexArray(),u.bindVertexArray(h.vao),void 0!==e&&null!==e&&(h.indexBuffer=u.createBuffer(),h.indexCount=e.length,u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,h.indexBuffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),u.STATIC_DRAW),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,null)),void 0!==r&&null!==r&&(h.vtxBuffer=u.createBuffer(),h.vtxComponents=3,h.vtxCount=r.length/h.vtxComponents,u.bindBuffer(u.ARRAY_BUFFER,h.vtxBuffer),u.bufferData(u.ARRAY_BUFFER,new Float32Array(r),u.STATIC_DRAW),u.enableVertexAttribArray(n),u.vertexAttribPointer(n,3,u.FLOAT,!1,0,0)),void 0!==i&&null!==i&&(h.normalBuffer=u.createBuffer(),u.bindBuffer(u.ARRAY_BUFFER,h.normalBuffer),u.bufferData(u.ARRAY_BUFFER,new Float32Array(i),u.STATIC_DRAW),u.enableVertexAttribArray(a),u.vertexAttribPointer(a,3,u.FLOAT,!1,0,0)),void 0!==o&&null!==o&&(h.uvBuffer=u.createBuffer(),u.bindBuffer(u.ARRAY_BUFFER,h.uvBuffer),u.bufferData(u.ARRAY_BUFFER,new Float32Array(o),u.STATIC_DRAW),u.enableVertexAttribArray(s),u.vertexAttribPointer(s,2,u.FLOAT,!1,0,0)),u.bindBuffer(u.ARRAY_BUFFER,null),u.bindVertexArray(null),this.meshs[t]=h,h},t.Vector3=f,t.Matrix4=c,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=czpg.min.js.map
