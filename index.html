<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>CraZyPG</title>
    <style>
        html, body {
            background: black;
            padding: 0px;
            margin: 0px;
            width: 100%;
            height: 100%;
        }
        canvas {
            display: block;
            width: 100vw;
            height: 100vh;
        }
        div {
            display: flex;
            width: 100%;
            height: 100%;
            align-items: center;
            justify-content: center;
        }
    </style>
</head>
<body>
    <div>
        <canvas id="glpaper"></canvas>
    </div>
    <script src="./build/czpg.js"></script>
    <script id='quad-vs' type="shader">#version 300 es
        in vec3 a_position;
        in vec2 a_uv;

        uniform mat4 u_world;
        uniform mat4 u_view;
        uniform mat4 u_proj;

        out vec2 v_uv;

        void main() {
            v_uv = a_uv;
            gl_Position = u_proj * u_view * u_world * vec4(a_position, 1.0);
        }
    </script>
    <script id="quad-fs" type="shader">#version 300 es
        precision mediump float;

        in vec2 v_uv;

        out vec4 finalColor;

        void main() {
            float c = (v_uv.x <=0.1 || v_uv.x >= 0.9 || v_uv.y <= 0.1 || v_uv.y >= 0.9) ? 0.0 : 1.0;
            finalColor = vec4(c, c, c, 1.0 - c);
        }
    </script>
    <script>
        class QuadShader extends CZPG.Shader{
            constructor(gl, projMat) {
                super(gl, 'quad-vs', 'quad-fs');
                this.setProjMatrix(projMat);
                gl.useProgram(null);
            }
        }

        CZPG.getContext('glpaper').setSize('80%', '80%', window.devicePixelRatio).clear();

        let camera = new CZPG.OrbitCamera(CZPG.gl);
        camera.transform.position.set(0, 1, 3);
        let cameraControler = new CZPG.CameraController(CZPG.gl, camera);

        let gridShader = new CZPG.GridAxisShader(CZPG.gl, camera.projMatrix);
        let gridMesh = CZPG.Primatives.GridAxis.createMesh(CZPG.gl);
        let gridModal = new CZPG.Modal(gridMesh);

        let quadShader = new QuadShader(CZPG.gl, camera.projMatrix);
        let quadModal = CZPG.Primatives.Quad.createModal();

        let loop = new CZPG.Render(function(timespan) {
            CZPG.fitSize().clear();
            camera.updateViewMatrix();
            camera.updateProjMatrix();
            gridShader.activate().setProjMatrix(camera.projMatrix).setViewMatrix(camera.viewMatrix)
                .renderModal(gridModal.preRender());
            quadShader.activate().setProjMatrix(camera.projMatrix).setViewMatrix(camera.viewMatrix)
                .renderModal(quadModal.preRender());
        }).start();
    </script>
</body>
</html>